if (self.CavalryLogger) { CavalryLogger.start_js(["e3tks"]); }

__d('MAdsScrollOnMarginTap',['MLegacyDataStore','DOM','Stratcom','MScrollAreaHelper','BanzaiODS'],(function a(b,c,d,e,f,g,h,i,j,k,l){var m='scroller-item-mask';function n(event){var r=event.getData();p(r.element);}function o(r){p(r.getData());}function p(r){var s=h.get(r);if(!s.scrollOnMarginTap)return;i.scry(r,'div',m).forEach(i.remove);var t=s.scrollArea,u=t.getScrollPageIndex(),v=t.getChildAtPageIndex(u),w={height:v.offsetHeight+'px',position:'absolute',top:0,width:v.offsetWidth+'px',zIndex:99};if(!t.isFirstPage()){var x=i.create('div',{onclick:t.scrollByPages.bind(t,-1),sigil:m,style:w}),y=t.getChildAtPageIndex(u-1);y.appendChild(x);}if(!t.isLastPage()){var z=i.create('div',{onclick:q.bind(),sigil:m,style:w}),aa=t.getChildAtPageIndex(u+1);aa.appendChild(z);}}function q(event){var r=k.findScrollArea(event.toElement);r.scrollByPages(1);l.bumpEntityKey('feed_ads','m_site_tap_on_margin_next');}j.listen('MScrollArea:create',null,n);j.listen('MScrollArea:scrollend','egoScroller',n);j.listen('m:ads-infinite-hscroll:loaded',null,o);f.exports={};}),null);
__d('MDynamicAdLogger',['$','MLegacyDataStore','DOM','FBJSON','MarauderLogger','JSLog','Stratcom','ge','XFeedEgoImpressionLoggingController','MRequest'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r='first_hscroll_ad_shown',s='new_hscroll_ad_shown',t='item',u='pixelContainer',v;function w(){if(!v){v=n.listen('MScrollArea:scrollend','egoScroller',y);n.listen('m:page:unload',null,function(){n.removeCurrentListener();v.remove();v=null;});}}function x(ca){var da=h(ca),ea=i.get(da),fa=aa(da,0);fa.forEach(function(ga){if(ga.element){z(da,ga);var ha=i.get(ga.element),ia={uid:ea.userId,adid:ha.adId,size:ea.size};l.log(r,ea.loggingModule,ia);}});}function y(event){var ca=event.getData(),da=ca.element,ea=i.get(da),fa=ca.scrollarea,ga=fa.getScrollPageIndex(),ha=fa.getScrollPageCount(),ia=aa(da,ga);ia.forEach(function(ja){var ka=ba(da)?(ha-1)*ea.groupSize+1:ha*ea.groupSize;if(ea.size==ja.count&&ea.size==ka&&ja.element){z(da,ja);var la=i.get(ja.element),ma={scrolled_by_user:ca.scrolledByUser,pos:ja.position,size:ea.size,uid:ea.userId,adid:la.adId};l.log(s,ea.loggingModule,ma);}else{var na=ea.size+", "+ja.count+", "+ha+", ";if(da){var oa=da.getAttribute('data-store');na+="id="+da.getAttribute('data-store-id');na+=" data="+oa;try{na+=" meta=";for(var pa in ea)na+=pa+",";ca=k.parse(oa,f.id);na+=" size2="+ca.size;}catch(qa){if(typeof JSON!=="undefined"){na+=" err";}else na+=" err2";}}m.error('Unexpected number of items reported by scrollArea : '+na);}});}function z(ca,da){if(da.element){var ea=i.get(da.element),fa=j.scry(ca.parentNode,'span',u)[0];if(fa&&ea.pixel){j.appendContent(fa,o(ea.pixel));ea.pixel=null;}if(ea.adId){var ga=i.get(ca);if(ga.loggedItems&&ga.loggedItems[ea.adId]||!ga.qid||!ga.mf_story_key)return;var ha=p.getURIBuilder().setInt('ego_id',ea.adId).setInt('qid',ga.qid).setInt('mf_story_key',ga.mf_story_key).getURI();new q(ha).send();if(!ga.loggedItems)ga.loggedItems={};ga.loggedItems[ea.adId]=true;}}}function aa(ca,da){if(ca){var ea=j.scry(ca,'*',t);if(!ea||ea.length<=0){m.error('no item sigil under scroll area');return [];}var fa=null,ga=j.scry(ca,'*','scroll-area-body')[0];if(ga){if(da>=ga.children.length){m.error('pageIndex '+da+' is larger then total page number '+ga.children.length);return [];}var ha=ga.children[da];fa=n.hasSigil(ha,t)?[ha]:j.scry(ha,'*',t);var ia=i.get(ca);if(!ia||!ia.groupSize||ia.groupSize<fa.length){m.error('More number of items in a group then expected: group size: '+(ia&&ia.groupSize)?ia.groupSize:'unknown'+' item number:'+fa.length);return [];}}else{if(da!==0){m.error('try to get page index not 0 when not scrolling. Index '+da);return [];}fa=ea;}return fa.map(function(ja){return {element:ja,count:ea.length,position:i.get(ja).position};});}}function ba(ca){return j.scry(ca,'*','m-hscroll-ego-loading').length>0;}f.exports={init:w,logImpression:x};}),null);
__d('MOrientationResize',['setTimeoutAcrossTransitions','DOM','MLegacyDataStore','MParent','Stratcom','Vector'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){var n,o=function p(q){var r='orientation-resizable',s='content-pane';if(n){t(q.id);return;}n=true;function t(ia){var ja=document.getElementById(ia);ja&&ca([{root:k.bySigil(ja,s),elements:[ja]}]);}function u(ia,ja){var ka=ja.padding||0,la=ja.aspectRatio||1,ma=ja.widthRatio||1,na=ja.containerAspectRatio,oa=ia*ma-ka;if(!na){var pa=oa,qa=Math.floor(oa/la);}else{var ra=oa,sa=ra/na,ta=ra/sa,ua=la,va=ua/ta;if(va>1){pa=ra;qa=1/va*sa;}else{pa=va*ra;qa=sa;}}return new m(pa,qa);}function v(ia,ja){var ka=ja.aspectRatio||1,la=ja.columnCount||1,ma=ja.gridPadding||0,na=ja.photoMargin||0,oa=ia-ma-(la-1)*na,pa=Math.floor(oa/la),qa=Math.ceil(pa/ka);return new m(pa,qa);}function w(ia,ja){var ka=ja.aspectRatio||1,la=ja.widthRatio||1,ma=ja.padding||0,na=ia*la,oa=na/ka;return new m(Math.round(na)-ma,Math.floor(oa)-ma);}function x(ia){var ja=ia.getData(),ka=i.scry(ja,'*',r);ka&&ca([{root:k.bySigil(ja,s),elements:ka}]);}var y,z;function aa(){z++;var ia=false,ja=i.scry(document,'*',s);if(ja&&ja.length){var ka=[];for(var la=0;la<ja.length;la++){var ma=ja[la],na=ma.offsetWidth,oa=j.get(ma),pa=oa&&oa.offsetWidth;if(na!==pa){j.set(ma,{offsetWidth:na});ia=true;ka.push({root:ma,elements:i.scry(ma,'*',r)});}}if(ka.length)ca(ka);}if(z<3)y=h(aa,500);if(ia)l.invoke('m:orientation-resize:complete');}function ba(){z=0;clearTimeout(y);aa();}function ca(ia){var ja=[];for(var ka=0;ka<ia.length;ka++){var la=ia[ka].root,ma=ia[ka].elements;if(!la||!ma)continue;var na=la.offsetWidth;if(na===0)continue;for(var oa=0;oa<ma.length;oa++){var pa=ma[oa],qa=j.get(pa),ra=null,sa;switch(qa.mode){case 'scale-photo-attachment':ra=u(na,qa);break;case 'scale-photo-relative-item':ra=w(na-qa.outerPadding,qa);break;case 'scale-photo-grid-item':ra=v(na,qa);break;case 'resize-to-unit':ra=da(na,pa,qa);break;case 'resize-feed-2-photos-attachment':sa=ga(na,pa,qa);ja=ja.concat(sa);continue;case 'resize-feed-3-photos-attachment':sa=ha(na,pa,qa);ja=ja.concat(sa);continue;default:continue;}ja.push({node:pa,width:ra.x,height:ra.y});}}ja.forEach(function(ta){if(!ta||!ta.node)return;ta.node.style.width=ta.width+'px';ta.node.style.height=ta.height+'px';});}function da(ia,ja,ka){var la=ka.padding||0,ma=ka.aspectRatio||1,na=ka.widthRatio||1,oa=ea(ja),pa=oa?m.getDim(oa).x:ia,qa=pa*na-la,ra=Math.floor(qa/ma);return new m(qa,ra);}function ea(ia){while(ia&&ia!=document){if(l.hasSigil(ia,'orientation-resize-parent'))return ia;ia=ia.parentNode;}return null;}function fa(ia,ja){var ka=ja==='P'?4/3:3/4;return Math.floor(ia*ka);}function ga(ia,ja,ka){var la=ka.orient,ma=ia-ka.spacing,na,oa,pa;if(la==='PL'||la==='LP'){var qa=Math.round(ma*ka.fraction),ra=ma-qa;pa=fa(qa,'L');if(la==='PL'){na=ra;oa=qa;}else{na=qa;oa=ra;}}else{na=Math.round(ma/2);oa=ma-na;pa=fa(na,la[0]);}var sa=i.scry(ja,'*','photoleft')[0],ta=i.scry(ja,'*','photoright')[0],ua=[];if(sa)ua.push({node:sa,width:na,height:pa});if(ta)ua.push({node:ta,width:oa,height:pa});return ua;}function ha(ia,ja,ka){var la=ia-ka.spacing,ma=Math.round(la*ka.fraction),na=la-ma,oa=fa(ma,ka.orient),pa=Math.floor(oa/2)-ka.margin,qa=oa-pa-ka.margin;return [{node:i.find(ja,'*','mainphoto'),width:ma,height:oa},{node:i.find(ja,'*','topphoto'),width:na,height:pa},{node:i.find(ja,'*','bottomphoto'),width:na,height:qa}];}if(q.id)t(q.id);l.listen(['m:viewport:orientation-change','m:page:render:complete','m:page:render:cache:complete','m:ajax:complete','m:plugin:resize'],null,ba);l.listen(['m:timeline:unit:resize','m-timeline-two-column-layout:pre-section-balance'],null,x);};g.main=o;}),null);
__d('MCroppedPhotoGrid',['setTimeoutAcrossTransitions','CSS','MLegacyDataStore','DOM','Stratcom'],(function a(b,c,d,e,f,g,h,i,j,k,l){var m='m-cropped-photo-grid',n=function q(r){var s=k.scry(r,'*','grid-item-deferred'),t=j.get(r);t.timer=null;var u=window.innerWidth*1.5,v=s.length-1;s.some(function(w,x){var y=j.get(w);if(!y.rendered){var z=w.getBoundingClientRect();if(z.left<=u){y.rendered=true;var aa=new Image();aa.onload=function(){i.conditionClass(w,'gridPhotoDeferred',false);aa.onload=null;};var ba=w.style.backgroundImage;ba=ba.replace(/.*url\((\"|\')?([^(\"|\')]*)(\"|\')?\).*/,'$2');aa.src=ba;t.complete=v===x;}else return true;}});},o=function q(r){var s=r.getNode(m),t=j.get(s);if(!t.complete)t.timer=h(n.bind(null,s),300);},p=function q(r){var s=r.getNode(m),t=j.get(s).timer;t&&clearTimeout(t);};l.listen('touchstart',m,p);l.listen('touchend',m,o);}),null);